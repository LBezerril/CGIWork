#!/bin/bash

#######################################################################
#                                                                     #
#                               CGIWork                               #
#                                                                     #
#  Description: Replace shell variables into an output file, keeping  #
#               your output files and shell scripts separated.        #
#                                                                     #
#  Usage: cgiwork "${ARRAY[@]}"                                       #
#                                                                     #
#  Important: The output file must be the first element of the array  #
#  Example of array: ARRAY=("templates/example.html");                #
#                    ARRAY+=("variable1=value1");                     #
#                    ARRAY+=("variable2=value2");                     #
#                                                                     #
#  Author: LBezerril                                                  #
#  To see the documentation, visit: github.com/LBezerril/CGIWork      #
#                                                                     #
#                                                                     #
#######################################################################

ARRAY=( "$@" );
INFO="${ARRAY[0]}" && unset ARRAY[0];
TYPES_SUPPORTED="plain|json|xml";
PATH=$PATH:/opt/cgiwork/scripts
MESSAGE_ERROR="CGIWork Error:";

type="$(echo "$INFO" | grep -E -o "type=($TYPES_SUPPORTED);" | sed 's/type=//g;s/;//g')";
if [[ "$type" != "" ]]; then
	. cgiwork_$type;
else
	echo "$MESSAGE_ERROR Invalid type!";
	exit 1;
fi;
